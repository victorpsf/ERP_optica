namespace Application.Repositories.Queries;

public static class AuthenticationQueries
{
    public static string VerifyAuthenticationUser = @"
SELECT 
	A1.AUTHID 		AS USERID,
    E1.ENTERPRISEID AS ENTERPRISEID,
    @TOKEN			AS TOKEN
FROM 		AUTH 				AS A1
INNER JOIN 	CREDENTIAL 			AS C1		ON C1.CREDENTIALID  = C1.CREDENTIALID
INNER JOIN  PERSON              AS P1       ON P1.PERSONID      = C1.PERSONID
INNER JOIN	AUTHXENTERPRISE 	AS A2		ON A2.AUTHID        = A1.AUTHID
INNER JOIN  ENTERPRISE 			AS E1		ON E1.ENTERPRISEID  = A2.ENTERPRISEID
WHERE 
		A1.DELETED_AT IS NULL
	AND C1.DELETED_AT IS NULL
    AND P1.DELETED_AT IS NULL
    AND A2.DELETED_AT IS NULL
    AND E1.DELETED_AT IS NULL
    
    AND A1.AUTHID 		= @USEID
    AND E1.ENTERPRISEID = @ENTERPRISEID
";
}
